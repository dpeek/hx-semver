package mtask.target;

/**
A utility class for retrieving parameters generated by the app target.
*/
class Param
{
	static var checked:Bool;
	static var data:Dynamic;

	public static var isAvailable(get_isAvailable, null):Bool;

	static function get_isAvailable():Bool
	{
		if (checked) return isAvailable;
		checked = true;

		var string = haxe.Resource.getString("params");
		isAvailable = (string != null);

		if (isAvailable) data = haxe.Json.parse(string);
		
		return data != null;
	}

	/**
	Return the value of a build parameter, or null if it is not found.
	*/
	public static function get(key:String):Dynamic
	{
		if (!isAvailable) throw "MTask params not available!";

		if (Reflect.hasField(data, key))
		{
			return Reflect.field(data, key);
		}
		
		return null;
	}
}